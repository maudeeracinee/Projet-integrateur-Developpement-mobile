<div class="joinPage-container">
    <div class="header">
        <div class="header-buttons">
            <button class="return-button" (click)="navigateToMain()">Retour</button>
        </div>
        <h2>Rejoins une partie!</h2>
        <div class="user-money">
            <app-virtual-money></app-virtual-money>
        </div>
    </div>

    <button class="chat-toggle-button" aria-label="Toggle global chat" (click)="isChatVisible = !isChatVisible">
        <span class="material-icons">chat_bubble_outline</span>
    </button>
    @if (isChatVisible) {
    <div class="global-chat-wrapper">
        <app-chatroom [isInGame]="false" (closed)="isChatVisible = false"></app-chatroom>
    </div>
    }
    <app-error-message-component></app-error-message-component>
    <app-join-game-modal></app-join-game-modal>

    <div class="map-view">
        <div class="section-header">
            <h3>Parties disponibles</h3>
        </div>
        <div class="game-grid">
            @if (activeGames.length > 0) { 
                @for (game of activeGames; track game.id) { 
                    <app-game-preview [game]="game" 
                        (join)="onJoin(game)" 
                        (rejoin)="onResume(game)" 
                        (observe)="onObserve(game)"> 
                    </app-game-preview>
                } 
            }
        </div>
    </div>
</div>
